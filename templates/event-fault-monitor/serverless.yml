service: ${self:custom.subsys}-event-fault-monitor

provider:
  name: aws
  deploymentBucket: ${file(serverless/cfn.yml):deploymentBucket}
  iam:
    deploymentRole: ${file(serverless/cfn.yml):deploymentRole}
    role: ${file(serverless/iam.yml):role}
  stackTags: ${file(serverless/tags.yml)}
  runtime: nodejs16.x
  logRetentionInDays: 30
  environment: ${file(serverless/config.yml):environment}

params: ${file(serverless/config.yml):params}
package:
  individually: true
custom:
  partition: aws # aws-us-gov
  org: my
  subsys: subsys1
  webpack:
    includeModules: true

plugins:
  - serverless-webpack
  - baton-vcr-serverless-plugin
  - serverless-offline

functions:
  trigger:
    handler: src/trigger/index.handle
    events:
      - sqs:
          arn:
            Fn::GetAtt: [ TriggerQueue, Arn ]


resources:
  - ${file(serverless/firehose.yml):resources}
  - ${file(serverless/s3.yml):resources}
  # - ${file(serverless/sns.yml):resources}
  # - ${file(serverless/sqs-trigger.yml):resources}
  - ${file(serverless/conditions.yml)}
